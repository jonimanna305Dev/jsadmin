<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>QR Code Generator with Logo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body {
            background: #f8f9fa;
        }

        .qr-wrapper {
            position: relative;
            display: inline-block;
        }

        .qr-wrapper img {
            width: 280px;
        }

        .qr-logo {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 64px;
            height: 64px;
            background: #fff;
            border-radius: 14px;
            transform: translate(-50%, -50%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 10px rgba(0,0,0,.2);
        }

        .qr-logo i,
        .qr-logo span {
            font-size: 32px;
            font-weight: bold;
        }

        /* Custom select preview */
        .icon-preview {
            font-size: 18px;
            margin-right: 8px;
        }
    </style>
</head>

<body>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6">

            <div class="card shadow-sm">
                <div class="card-body text-center">

                    <h4 class="mb-4">QR Code Maker</h4>

                    <select id="socialSelect" class="form-select mb-3">
                        <option value="">No Social (Auto Letter)</option>
                        <option value="facebook" data-icon="bi-facebook" data-color="#1877f2">Facebook</option>
                        <option value="youtube" data-icon="bi-youtube" data-color="#ff0000">YouTube</option>
                        <option value="whatsapp" data-icon="bi-whatsapp" data-color="#25d366">WhatsApp</option>
                        <option value="tiktok" data-icon="bi-tiktok" data-color="#000000">TikTok</option>
                        <option value="twitter" data-icon="bi-twitter" data-color="#1da1f2">Twitter</option>
                    </select>

                    <input type="url" id="urlInput" class="form-control mb-3" placeholder="Enter URL (e.g. https://www.upwork.com)">
                    <textarea id="textInput" class="form-control mb-3" placeholder="Or enter text"></textarea>

                    <button class="btn btn-primary w-100" onclick="generateQR()">Generate QR</button>

                    <div id="qrSection" class="mt-4 d-none">
                        <div class="qr-wrapper mb-3">
                            <img id="qrImg">
                            <div class="qr-logo">
                                <i id="qrIcon" class="d-none"></i>
                                <span id="qrLetter" class="d-none"></span>
                            </div>
                        </div>

                        <br>
                        <button class="btn btn-success" onclick="downloadQR()">
                            <i class="bi bi-download"></i> Download QR
                        </button>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>

<script>
let logoType = 'letter';
let logoValue = '';
let logoColor = '#000';
let siteName = 'qr';

function getSiteLetter(url) {
    try {
        let host = new URL(url).hostname.replace('www.', '');
        return host.charAt(0).toUpperCase();
    } catch {
        return 'Q';
    }
}

function generateQR() {
    const url = urlInput.value.trim();
    const text = textInput.value.trim();
    const select = socialSelect.options[socialSelect.selectedIndex];

    if (!url && !text) {
        alert('Please enter URL or text');
        return;
    }

    const data = url || text;
    siteName = url ? getSiteLetter(url) : 'QR';

    const icon = select.getAttribute('data-icon');
    const color = select.getAttribute('data-color');

    qrIcon.classList.add('d-none');
    qrLetter.classList.add('d-none');

    if (icon) {
        logoType = 'icon';
        logoValue = icon;
        logoColor = color;

        qrIcon.className = icon;
        qrIcon.style.color = color;
        qrIcon.classList.remove('d-none');
    } else {
        logoType = 'letter';
        logoValue = siteName;
        logoColor = '#0d6efd';

        qrLetter.textContent = siteName;
        qrLetter.style.color = logoColor;
        qrLetter.classList.remove('d-none');
    }

    qrImg.src = `https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(data)}`;
    qrSection.classList.remove('d-none');
}

function downloadQR() {
    const canvas = document.createElement('canvas');
    const size = 300;
    canvas.width = size;
    canvas.height = size;
    const ctx = canvas.getContext('2d');

    const img = new Image();
    img.crossOrigin = 'anonymous';
    img.src = qrImg.src;

    img.onload = () => {
        ctx.drawImage(img, 0, 0, size, size);

        const logoSize = 64;
        const x = (size - logoSize) / 2;
        const y = (size - logoSize) / 2;
        const r = 14;

        ctx.fillStyle = '#fff';
        ctx.beginPath();
        ctx.moveTo(x + r, y);
        ctx.lineTo(x + logoSize - r, y);
        ctx.quadraticCurveTo(x + logoSize, y, x + logoSize, y + r);
        ctx.lineTo(x + logoSize, y + logoSize - r);
        ctx.quadraticCurveTo(x + logoSize, y + logoSize, x + logoSize - r, y + logoSize);
        ctx.lineTo(x + r, y + logoSize);
        ctx.quadraticCurveTo(x, y + logoSize, x, y + logoSize - r);
        ctx.lineTo(x, y + r);
        ctx.quadraticCurveTo(x, y, x + r, y);
        ctx.fill();

        ctx.fillStyle = logoColor;
        ctx.font = 'bold 36px Arial';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';

        const drawText = logoType === 'letter'
            ? logoValue
            : logoValue.replace('bi-', '').charAt(0).toUpperCase();

        ctx.fillText(drawText, size / 2, size / 2);

        const link = document.createElement('a');
        link.download = `${siteName}-qr.png`;
        link.href = canvas.toDataURL();
        link.click();
    };
}
</script>

</body>
</html>
